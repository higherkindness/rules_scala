dist: xenial
sudo: required
language: generic

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - wget
      - pkg-config

cache:
    directories:
      - ~/.bazel_binaries
      - .bazel_cache

# some could be global, but these are OS-specific and ought not to be included
# in the UI or the cache key
_linux: &linux
  os: linux
_osx: &osx
  os: osx
  osx_image: xcode10.1

os:
  - linux
  - osx
env:
  - BAZEL_VERSION=2.1.0
  - BAZEL_VERSION=2.2.0

jobs:
  include:
# Build
    - stage: build
      script: ./scripts/travis.sh build
      script: ./scripts/travis.sh build
# Lint
    - stage: lint
      script: ./scripts/travis.sh lint
# Test
    - stage: test
      script: ./scripts/travis.sh test
      script: ./scripts/travis.sh test
